language: node_js
node_js:
  - "8"

os: [linux]
dist: trusty
sudo: required
cache:
  yarn: true


before_install:
  - curl -o- -L yarnpkg.com/install.sh | bash
  - export PATH=$HOME/.yarn/bin:$PATH
  - npm install --global lerna

install:
  - lerna bootstrap
  - cd packages/necmttn-gatsby
  - yarn run build

deploy:
  - provider: surge
    project: ./packages/necmttn-gatsby/public/
    domain: necmttn.surge.sh
    skip_cleanup: true
  - provider: pages
    local_dir: ./packages/necmttn-gatsby/public/
    skip_cleanup: true
    github_token: $GITHUB_TOKEN # Set in travis-ci.org dashboard

notifications:
  slack: baseglobal:KxtArmRFfzZ7DGi1zVABMJ9s:KxtArmRFfzZ7DGi1zVABMJ9s#deployment
